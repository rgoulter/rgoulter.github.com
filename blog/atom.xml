<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <title>Richard Goulter's Blog</title>
    <link href="http://www.rgoulter.com/blog//atom.xml" rel="self" />
    <link href="http://www.rgoulter.com/blog/" />
    <id>http://www.rgoulter.com/blog//atom.xml</id>
    <author>
        <name>Richard Goulter</name>
        <email>richard.goulter+blog@gmail.com</email>
    </author>
    <updated>2022-02-20T00:00:00Z</updated>
    <entry>
    <title>Using Home Manager to Manage Symlinks to Dotfiles</title>
    <link href="http://www.rgoulter.com/blog//posts/programming/2022-02-20-using-home-manager-to-manage-symlinks-to-dotfiles.html" />
    <id>http://www.rgoulter.com/blog//posts/programming/2022-02-20-using-home-manager-to-manage-symlinks-to-dotfiles.html</id>
    <published>2022-02-20T00:00:00Z</published>
    <updated>2022-02-20T00:00:00Z</updated>
    <summary type="html"><![CDATA[<p><a href="https://github.com/anishathalye/dotbot">dotbot</a> is a popular way of managing symlinks to dotfiles, and I used it for some time.</p>
<p>I’ve gradually been becoming more comfortable with <a href="https://nixos.org/">Nix</a>.</p>
<p>Nix remains relatively niche, so: Nix allows programmatic management of packages installed to a computer. Nix refers to the expression language that describes these packages, the tool which evaluates these expressions. It’s also pretty closely tied to Nixpkgs (a large repository of packages), and NixOS (a Linux distribution which is configured using Nix expressions).</p>
<p>Nix tooling is friendly towards words like “declarative” and “X-as-Code”.</p>
<p><a href="https://github.com/nix-community/home-manager">Home Manager</a> is a popular tool which uses Nix configurations to manage a user’s environment, in a similar manner to how NixOS’s system is configured from a Nix file.<br />
It complements NixOS, but I’ve been happy to use NixOS (or nix on macOS) without having tried home manager.</p>
<p>I was hesitant to try Home Manager, since I didn’t wanna have “vendor lock-in” and be unable to make use of my dotfiles elsewhere.</p>
<p>To be honest: whenever Nix pops up, I often see people say they don’t like the Nix language, and that its error messages are hard to understand. My experience with Nix before this was using it to describe Python packages, or Go applications, or describe a declarative set of packages to use, and using NixOS.<br />
– If people’s first experience with Nix is with home manager, I can see why Nix might seem more trouble than it’s worth.</p>
<p>Here are my notes on the steps I took, following the <a href="https://nix-community.github.io/home-manager/">home manager manual</a> and <a href="https://nixos.wiki/wiki/Home_Manager">the NixOS wiki page on Home Manager</a>.</p>
<h1 id="a-taste-of-nixos-but-for-your-home-directory">A Taste of NixOS, but for Your Home Directory</h1>
<p>EDIT: Having tried this a bit.. one significant difference from the dotbot approach: dotbot manages symlinks so that e.g. <code>~/.vimrc</code> links to the repository where the dotbot was run from. The home-manager approach first constructs a Nix package with the configuration files, then symlinks to these files.</p>
<p>This demands a change in mindset, since this means the file which <code>~/.vimrc</code> symlinks to is read-only.<br />
This makes more sense if describing the configuration files using Nix, compared to the approach described below (which attempts to model dotbot).</p>
<p>I don’t mind “can’t edit the (generated) configuration files” when it comes to OS files. I find it slightly more awkward with configuration files for Vim or Emacs.</p>
<p>It’s often possible for configuration files to <code>include</code> other configuration files. This is one way to “work around” the above restriction.</p>
<h1 id="installing-home-manager">Installing Home Manager</h1>
<p>I’d recently started using Nix flakes. Nix flakes are cool.</p>
<p>So, following the <a href="https://nix-community.github.io/home-manager/index.html#ch-nix-flakes">standalone setup with Nix Flakes</a> chapter of the manual..</p>
<p>The ‘trouble’ is, per discussion in <a href="https://github.com/nix-community/home-manager/pull/2461">nix-community/home-manager#2461</a>, Home Manager doesn’t support the new “nix command” style of profile management.<br />
i.e. Installing a package in nix classic would be <code>nix-env -iA nixpkgs.neovim</code>, but with the new nix command style it’s <code>nix profile install nixpkgs#neovim</code>.<br />
And the old style of command is incompatible with the new style, so you can’t use the old <code>nix-env</code> commands once you’ve used <code>nix profile</code>.</p>
<p>The PR provides people with forks which fix the issue. Worked for me.</p>
<p>Here’s <a href="https://github.com/rgoulter/dotfiles/commit/01238a1421b7cf48d92451bd63505b5c1c721e79">the commit</a> with the simple <code>home.nix</code> and <code>flake.nix</code> that I started with:</p>
<p><code>flake.nix</code> (which is pretty much boilerplate):</p>
<pre><code>{
  description = &quot;rgoulter&#39;s Home Manager configuration&quot;;

  inputs = {
    nixpkgs.url = &quot;github:NixOS/nixpkgs/nixpkgs-unstable&quot;;
    home-manager = {
      # https://github.com/nix-community/home-manager/pull/2461
      inputs.nixpkgs.follows = &quot;nixpkgs&quot;;
      # Fork which allows using `nix profile` instead of `nix-env`
      # https://github.com/FlorianFranzen/home-manager/commit/4e97b01b2737bb0f39c18a65d87dd98659391b97
      # url = {
      type  = &quot;github&quot;;
      owner = &quot;FlorianFranzen&quot;;
      repo  = &quot;home-manager&quot;;
      rev   = &quot;4e97b01b2737bb0f39c18a65d87dd98659391b97&quot;;
    };
  };

  outputs = { home-manager, ... }:
    let
      system = &quot;x86_64-linux&quot;;
      username = &quot;rgoulter&quot;;
    in {
      homeConfigurations.&quot;${username}-${system}&quot; = home-manager.lib.homeManagerConfiguration {
        inherit system username;

        configuration = import ./home.nix;

        homeDirectory = &quot;/home/${username}&quot;;

        # Update the state version as needed.
        # See the changelog here:
        # https://nix-community.github.io/home-manager/release-notes.html
        stateVersion = &quot;22.05&quot;;
      };
    };
}</code></pre>
<p>(I went with <code>rgoulter-x86_64-linux</code> as the profile name since I’m not sure how home manager configurations interact with flake outputs. Presumably <code>rgoulter</code> would work just as well instead).</p>
<p>and the <code>home.nix</code>:</p>
<pre><code>{ config, pkgs, ... }:

{
  home.stateVersion = &quot;22.05&quot;;

  programs.home-manager.enable = true;
}</code></pre>
<p>And following the commands given in the manual. Since I was running this from a git repository on my machine:</p>
<pre><code>nix build --no-link .#homeConfigurations.rgoulter-x86_64-linux.activationPackage
&quot;$(nix path-info .#homeConfigurations.rgoulter-x86_64-linux.activationPackage)&quot;/activate</code></pre>
<h1 id="symlinking-to-existing-dotfiles">Symlinking to Existing Dotfiles</h1>
<p>Or “using home manager instead of dotbot”.</p>
<p>Dotbot takes an <a href="https://github.com/rgoulter/dotfiles/blob/aa026733cf7c2bcdebc59a4a527257479549694f/install.conf.yaml">install.conf.yaml</a> to configure what files to link where.</p>
<p>Home Manager <em>can</em> use nix to write various config files. But it can also just symlink given some source files.</p>
<p><a href="https://github.com/rgoulter/dotfiles/commit/aa026733cf7c2bcdebc59a4a527257479549694f">Commit</a>.</p>
<p>Updated <a href="https://github.com/rgoulter/dotfiles/blob/aa026733cf7c2bcdebc59a4a527257479549694f/home.nix"><code>home.nix</code></a>:</p>
<pre><code>{ config, pkgs, ... }:

{
  home.stateVersion = &quot;22.05&quot;;

  programs.home-manager.enable = true;

  # files in ~/.config/
  xdg.configFile.&quot;alacritty/alacritty.yml&quot;.source = ./alacritty.yml;
  xdg.configFile.&quot;emacs-rgoulter/init.el&quot;.source  = ./emacs.el;
  # etc.

  # files in ~/
  home.file.&quot;.emacs-profiles.el&quot;.source = ./emacs-profiles.el;
  home.file.&quot;.gvimrc&quot;.source = ./gvimrc;
  # etc.

  # Using the submodule in this dotfiles repo would make
  # require a more awkward flake URI.
  home.file.&quot;.nvim/bundle/Vundle.vim&quot;.source = pkgs.fetchFromGitHub {
    owner = &quot;VundleVim&quot;;
    repo = &quot;Vundle.vim&quot;;
    rev = &quot;cfd3b2d388a8c2e9903d7a9d80a65539aabfe933&quot;;
    sha256 = &quot;sha256-OCCXgMVWj/aBWLGaZmMr+cD546+QgynmEN/ECp1r08Q=&quot;;
  };
}</code></pre>
<p>The <code>xdg.configFile.&lt;name&gt;.source</code> (and <code>home.file.&lt;name&gt;.source</code>) are given as examples on the <a href="https://nixos.wiki/wiki/Home_Manager#Managing_your_dotfiles">Home Manager page in the NixOS wiki</a>, and documented in <a href="https://nix-community.github.io/home-manager/options.html">Appendix A of the Home Manager manual</a>.</p>
<p>I can then apply the <code>home.nix</code> with, as the <a href="https://nix-community.github.io/home-manager/options.html">Home Manager manual</a> explains:</p>
<pre><code>home-manager switch --flake &#39;.#rgoulter-x86_64-linux&#39;</code></pre>
<h1 id="first-steps-in-refactoring">First Steps in Refactoring</h1>
<p>As can be seen in the above commit, it’s … not pretty.</p>
<p>Look. Complain about or be aware of <a href="https://mikehadlow.blogspot.com/2012/05/configuration-complexity-clock.html">the Configuration Complexity Clock</a>. But we’re at DSL o’clock here:</p>
<p>First step is to extract the attribute set out to <code>let ... in</code> bindings.</p>
<p><a href="https://github.com/rgoulter/dotfiles/commit/0663950cc3e564c35a0df9bf65c06fd66b8a83e6">Commit</a></p>
<p>Updated <a href="https://github.com/rgoulter/dotfiles/blob/0663950cc3e564c35a0df9bf65c06fd66b8a83e6/home.nix"><code>home.nix</code></a>:</p>
<pre><code>{ config, pkgs, ... }:

let
  # Attribute set for dotfiles in this repo to link into ~/.config.
  # The attribute name is for ~/.config/$attrSetName,
  #  e.g. &quot;alacritty/alacritty.yml&quot; for ~/.config/alacritty/alacritty.yml
  # The attribute value is the path to the dotfile in this repo.
  configFilesToLink = {
    &quot;alacritty/alacritty.yml&quot; = ./alacritty.yml;
    &quot;emacs-rgoulter/init.el&quot;  = ./emacs.el;
    &quot;emacs-rgoulter/straight/versions/default.el&quot;  = ./emacs.d/straight/versions/default.el;
    # etc.
  };

  # Attribute set for dotfiles in this repo to link into home directory.
  # The attribute name is for ~/$attrSetName,
  #  e.g. &quot;.hgrc&quot; for ~/.hgrc.
  # The attribute value is the path to the dotfile in this repo.
  homeFilesToLink = {
    &quot;.emacs-profiles.el&quot; = ./emacs-profiles.el;
    &quot;.gvimrc&quot; = ./gvimrc;
    # etc.
  };

  # Function to help map attrs for symlinking home.file, xdg.configFile
  # e.g. from { &quot;.hgrc&quot; = ./hgrc; } to { &quot;.hgrc&quot;.source = ./hgrc; }
  toSource = configDirName: dotfilesPath: { source = dotfilesPath; };
in
{
  # Symlink files under ~, e.g. ~/.hgrc
  home.file = pkgs.lib.attrsets.mapAttrs toSource homeFilesToLink;

  # Symlink files under ~/.config, e.g. ~/.config/alacritty/alacritty.yml
  xdg.configFile = pkgs.lib.attrsets.mapAttrs toSource configFilesToLink;

  # ...
}</code></pre>
<p>I figured out to use <code>lib.attrsets.mapAttrs</code> by looking at this <a href="https://teu5us.github.io/nix-lib.html">helpful community-provided documentation page</a>. But otherwise, the Nix manual has a chapter on <a href="https://nixos.org/manual/nix/stable/expressions/builtins.html">its builtin functions</a>, and the <a href="https://nixos.org/manual/nixpkgs/stable/#chap-functions">Nixpkgs manual has a chapter on its library functions</a>.</p>
<p>To help read the above code, the example given for <code>mapAttrs</code> is:</p>
<pre><code>lib.attrsets.mapAttrs
  (name: value: name + &quot;-&quot; + value)
  { x = &quot;foo&quot;; y = &quot;bar&quot;; }
=&gt; { x = &quot;x-foo&quot;; y = &quot;y-bar&quot;; }</code></pre>
<p>I think this level of functional programming is relatively accessible.</p>
<h1 id="refactoring-a-bit-further">Refactoring a bit Further</h1>
<p>I mean, the above is okay, but it’s just nagging seeing code like <code>.gvimrc&quot; = ./gvimrc;</code>.</p>
<p>People have different tastes as how how implicit vs explicit they’d prefer things. It’s hardly a burden to be explicit if you’re unfamiliar with the domain.</p>
<p>But I had to try. <a href="https://github.com/rgoulter/dotfiles/commit/6375425ed54d63b807a43c77acdee5acf4680a23">Commit</a>.</p>
<p>Updated <a href="https://github.com/rgoulter/dotfiles/blob/6375425ed54d63b807a43c77acdee5acf4680a23/home.nix"><code>home.nix</code></a>:</p>
<pre><code>{ config, pkgs, ... }:

let
  # e.g. given &quot;alacritty/alacritty.yml&quot;,
  # return the attrset { &quot;alacritty/alacritty.yml&quot; = ./alacritty/alacritty.yml; }.
  genAttrsForSimpleLink = fileName: ./. + (&quot;/&quot; + fileName);

  # e.g. given &quot;hgrc&quot;
  # return the attrset { &quot;.hgrc&quot; = ./hgrc; }.
  genAttrsForSimpleDotLink = fileName: { &quot;.${fileName}&quot; = ./. + (&quot;/&quot; + fileName); };

  # ...

  # List of dotfiles where the path to link under
  # ~/.config/ matches the path in the dotfiles repo.
  # e.g. ~/.config/alacritty/alacritty.yml matches ./alacritty/alacritty.yml.
  simpleConfigFilesToLinkList = [
    &quot;fish/config.fish&quot;
    &quot;kitty/kitty.conf&quot;
    &quot;starship.toml&quot;
    # etc.
  ];

  # Files where the symlinks aren&#39;t following a nice convention.
  unconventionalConfigFilesToLink = {
    &quot;emacs-rgoulter/init.el&quot;  = ./emacs.el;
    &quot;nvim/init.vim&quot; = ./vimrc;
    # etc.
  };

  # e.g. &quot;gvimrc&quot; to link &quot;~/.gvimrc&quot; to ./gvimrc
  simpleHomeFilesToLinkList = [
    &quot;gvimrc&quot;
    &quot;hgrc&quot;
    &quot;tmux.conf&quot;
    &quot;vimrc&quot;
    # etc.
  ];

  unconventionalHomeFilesToLink = {
    &quot;.nvim/after/ftplugin/org.vim&quot; = ./vim/after/ftplugin/org.vim;
    &quot;.nvim/bundle/Vundle.vim&quot; = vundleRepoSrc;
    &quot;.vim/bundle/Vundle.vim&quot; = vundleRepoSrc;
  };

  # Attribute set for dotfiles in this repo to link into ~/.config.
  # The attribute name is for ~/.config/$attrSetName,
  #  e.g. &quot;alacritty/alacritty.yml&quot; for ~/.config/alacritty/alacritty.yml
  # The attribute value is the path to the dotfile in this repo.
  configFilesToLink =
    (pkgs.lib.attrsets.genAttrs simpleConfigFilesToLinkList genAttrsForSimpleLink) //
    unconventionalConfigFilesToLink;

  # Attribute set for dotfiles in this repo to link into home directory.
  # The attribute name is for ~/$attrSetName,
  #  e.g. &quot;.hgrc&quot; for ~/.hgrc.
  # The attribute value is the path to the dotfile in this repo.
  homeFilesToLink =
    (pkgs.lib.lists.foldr (a: b: a // b) {} (map genAttrsForSimpleDotLink simpleHomeFilesToLinkList)) //
    unconventionalHomeFilesToLink;
in
{
  # Symlink files under ~, e.g. ~/.hgrc
  home.file = pkgs.lib.attrsets.mapAttrs toSource homeFilesToLink;

  # Symlink files under ~/.config, e.g. ~/.config/alacritty/alacritty.yml
  xdg.configFile = pkgs.lib.attrsets.mapAttrs toSource configFilesToLink;

  # ...
}</code></pre>
<p>This one takes a bit more explaining.</p>
<p>In order to get from <code>[ &quot;fish/config.fish&quot; ]</code> to <code>{ &quot;fish/config.fish&quot; = ./fish/config.fish; }</code>, <code>genAttrs</code> can be used.</p>
<pre><code>lib.attrsets.genAttrs [ &quot;foo&quot; &quot;bar&quot; ] (name: &quot;x_${name}&quot;)
=&gt; { foo = &quot;x_foo&quot;; bar = &quot;x_bar&quot;; }</code></pre>
<p>Hence, we can factor out the files which follow a nice convention to just a list, and construct <code>configFilesToLink</code> with:</p>
<pre><code># e.g. given &quot;alacritty/alacritty.yml&quot;,
# return the attrset { &quot;alacritty/alacritty.yml&quot; = ./alacritty/alacritty.yml; }.
genAttrsForSimpleLink = fileName: ./. + (&quot;/&quot; + fileName);

configFilesToLink =
  (pkgs.lib.attrsets.genAttrs simpleConfigFilesToLinkList genAttrsForSimpleLink) //
  unconventionalConfigFilesToLink;</code></pre>
<p>Unfortunately, to get <code>[ &quot;vimrc&quot; ]</code> into <code>{ &quot;.vimrc&quot; = ./vimrc }</code>, this involves transforming “vimrc” to “.vimrc”, it’s a bit more involved:</p>
<pre><code># e.g. given &quot;hgrc&quot;
# return the attrset { &quot;.hgrc&quot; = ./hgrc; }.
genAttrsForSimpleDotLink = fileName: { &quot;.${fileName}&quot; = ./. + (&quot;/&quot; + fileName); };

homeFilesToLink =
  (pkgs.lib.lists.foldr (a: b: a // b) {} (map genAttrsForSimpleDotLink simpleHomeFilesToLinkList)) //
  unconventionalHomeFilesToLink;</code></pre>
<p>(where <code>pkgs.lib.lists.foldr (a: b: a // b) {}</code> is essentially <code>listToAttrs</code>, but my version of Nix didn’t have this. In nix, <code>{ a = 3; } // { b = 4; }</code> evaluates to <code>{ a = 3; b = 4; }</code>).</p>]]></summary>
</entry>
<entry>
    <title>Deborah Tannen's You Just Don't Understand is Wonderful</title>
    <link href="http://www.rgoulter.com/blog//posts/argument/2022-01-11-deborah-tannens-you-just-dont-understand-is-wonderful.html" />
    <id>http://www.rgoulter.com/blog//posts/argument/2022-01-11-deborah-tannens-you-just-dont-understand-is-wonderful.html</id>
    <published>2022-01-11T00:00:00Z</published>
    <updated>2022-01-11T00:00:00Z</updated>
    <summary type="html"><![CDATA[<p>I finally finished reading through Deborah Tannen’s “You Just Don’t Understand”. It’s interesting to see that it was published in 1990. I’d put it alongside Jonathan Haidt’s “The Righteous Mind” as a book which provides a no-fault explaination for behaviour which seems illogical.</p>
<p>The core of the book is that some of the conflict which arises between men and women arises resembles conflict which arises due to inter-cultural differences. Sometimes a man will say something intending to be supportive, but it comes across as offensive to a woman (or vice versa).<br />
The model of interaction Tannen notes from observation is that typically men interact with the world with an emphasis on competition, with a sensitivity to their place in hierarchies, prioritising individuality and independence; and that typically women interact with the world with an emphasis on cooperation, with sensitivity to their place in communities, prioritising connection and intimacy. (The author is aware that people are complicated, and that such a partitioning won’t describe everyone, etc.).</p>
<p>The chapters in the book generally give an example of an interaction, and use the model to explain the situation. The example interactions are about how the gendered differences play out in telling jokes, or in presenting/lecturing, in domestic conversations, in work meetings, in political leadership, etc..<br />
– One example of a difference was that in classroom discussions, the competition-oriented style is more inclined to answer questions and give opinions, whereas a communal-oriented style is more inclined to avoid offending. (e.g. avoiding conflict of disagreeing, or appearing to not be equal to others).</p>
<p>One example (which apparently the book introduced to wider culture) was that “men don’t want to ask for directions”. Asking for directions makes you dependent on someone else for help.<br />
I think anyone in a relationship who reads through the book will be reminded of misunderstandings they’ve had with their partner.</p>
<p>An recurring example of how human interaction is complicated comes up in situations where one person helps another. Lending support might be a show of superiority, or an obligation from a subordinate position.</p>
<p>In the afterword of the book’s reprint, Tannen discusses that many people asked her whether she thought the differences in conversation style were biological, or cultural. She felt that many of the people asking had already made their minds up:<br />
those who felt the differences were biological felt (typically men) felt that this meant there was no need for the status quo to change,<br />
vs those who felt the differences were cultural (typically women; although I’d expect these days it would typically be progressives) and felt that this meant the conversation styles malleable.<br />
– Tannen’s opinion (which she qualifies by saying it’s not within her domain of research) is that it’s not fully biological, but that cultural values are unlikely to change quickly. The differences should be understood as they are, as to mitigate the impact of conflicts arising from differences.</p>
<p>The book’s foreword similarly makes an interesting claim, as to why we should care about differences:</p>
<blockquote>
<p>Pretending that women and men are the same hurts women, because the ways they are treated are based on the norms for men. It also hurts men who, with good intentions, speak to women as they would to men, and are nonplussed when their words don’t work as they expected, or even spark resentment and anger.</p>
<p>This paradox is expressed by an American Indian woman, Abby Abinati, describing why she found law school a difficult and alienating experience:</p>
<blockquote>
<p>People did not like or accept the idea of Indians or women being lawyers. Some people could not decide which idea they hated more. Some pretended that it didn’t make any difference, that we were all the same. I, too, could be “one of the boys,” “one of the white boys.” Not likely. Both of these approaches created problems for me.</p>
</blockquote>
</blockquote>
<p>That some people thought she as a woman or an Indian shouldn’t be a lawyer is awful.<br />
That she felt her identity as an Indian and a woman meant she felt left out when she was treated the same way as others would treat a white man… while it seems reasonable to say that people who are different should be recognised as different, but “treat people differently” just sounds disrespectful. – It’s natural to ask “What problems did it create for you? If not treated the same as ‘one of the white boys’, how’d you expect to be treated?”.</p>
<p>These days, there’s plenty of discussion towards the goal of reducing alienation of people who look different. But, there seems to be an underlying assumption that there’s no substantial difference in the way people interact.<br />
– When differences are brought up, it kinda follows the two reactions mentioned above (“innate differences, nothing to be done” vs “the differences don’t exist! so, you’re saying women are inferior!?”). I think it’d be better if there were more acknowledgement of differences, and examples of ways to work with those differences.</p>
<p>I think the book’s treatment of cross-cultural communication is better than what gets passed around on Twitter.<br />
e.g. the word “mansplaining” was only coined in the Twitter-era, and has come to be used as an unnecessarily-gendered substitute for the word “patronising”. The word’s initial usage, IIRC, was as by a female author frustrated by a conversation where a man explained her own book to her.<br />
– Conflicts like this are typical of the kinds of inter-gender conflicts the book discusses. Tannen’s typical explanation is that a man is inclined to compete, to demonstrate his skill, with the expectation that a conversation partner reciprocate the competition; that a woman is inclined to cooperate, to not offend, and expect a conversation partner to not dominate a conversation.<br />
– Twitter’s interpretation is that this conflict doesn’t happen between men, because men don’t patronise other men; Tannen’s interpretation is that this conflict doesn’t happen between men, because a man would simply reply “I know, I wrote the book”. Twitter’s interpretation is that men’s behaviour is pigheaded. Tannen’s interpretation is that the conflict arises due to different conversation styles.</p>
<p>I guess it’d be easy to paper-over the different styles of interaction.<br />
From a framing where interaction is pro-competitive, and everything about one’s place in a hierarchy.. then interactions which style things in a social way seem frilly and stupid.<br />
From a framing where interaction is pro-cooperative, and everything about one’s belonging to a group.. then interactions which style things in a competitive way are brash and crude.<br />
– But it seems to me less dignity is lost (and less conflict is had) by considering these as different styles.</p>]]></summary>
</entry>
<entry>
    <title>It's Difficult to Explain Technical Difficulties Encountered</title>
    <link href="http://www.rgoulter.com/blog//posts/programming/2021-12-26-its-difficult-to-explain-technical-difficulties-encountered.html" />
    <id>http://www.rgoulter.com/blog//posts/programming/2021-12-26-its-difficult-to-explain-technical-difficulties-encountered.html</id>
    <published>2021-12-26T00:00:00Z</published>
    <updated>2021-12-26T00:00:00Z</updated>
    <summary type="html"><![CDATA[<p>If you’re using a computer, and something doesn’t work, sometimes the best you can come up with when asking for help is: “it doesn’t work”.</p>
<p>Maybe you can be a bit more specific and say “I’ve plugged in my headphones, and they don’t work”.</p>
<p>But no one is ever going to say “I’ve got a headset, and I plugged the cable with the microphone icon into the jack with the headphone icon, and vice versa, and I can’t hear audio playing through the headset”.</p>
<p>Once you understand what’s going on enough to know what facts are significant, you probably know enough to find help on your own.<br />
But if you don’t understand, then asking for help in a useful way is kindof difficult.</p>
<p>(From the asker’s side, this just means you can’t find the solution to your problem. But for troubleshooting sites like Reddit forums or StackOverflow, it means most of the questions posted are of low quality).</p>
<hr />
<p>NixOS can be difficult to use.<br />
I’d say it’s 95% wonderful, 5% pain in the arse to use.<br />
The “gotta know what you’re doing” aspect both leads to and exasperates that painful part.</p>
<p>Well, Linux in general can be a pain to use.<br />
Though, there’s an old half-joke that a lot of programming work involves a loop of writing code, compiling, copying the error message into Google and copy-pasting the answer from StackOverflow.<br />
– If you run into a problem trying to do something on Linux, you’ll probably be able to find some StackOverflow answer which can help you out. You can often get away with not really understanding what’s going on. (Or, rather, “deferring understanding to a later date”).</p>
<p>With NixOS, there are some factors such that copy-paste-from-StackOverflow doesn’t help out:</p>
<ul>
<li><p>Nix/NixOS’s community is relatively small. So you’re less likely to find someone who’s tried the same thing as you’re trying to do (&amp; asked about it) compared to some other Linux distribution.</p></li>
<li><p>NixOS is weird. Comparing, say, Ubuntu to Arch to CentOS.. they have different ways of installing packages, and will put configuration files in different places, but more/less if you see how to fix something in one distribution, you’ll be able to apply that to another distribution. – This isn’t necessarily the case with NixOS.</p></li>
<li><p>Sometimes the problem you run into will be a Linux problem, that you would run into with any Linux distribution. (e.g. setting up Bluetooth). Or it might be because the program is trying to do things which doesn’t work with how Nix arranges its packages. – But you have to understand what’s going on in order to be able to even distinguish.</p></li>
</ul>
<p>One example I find notorious is the <a href="https://github.com/NixOS/nix/issues/2259">“hello world” in the manual doesn’t build</a>. Rather, I’d expect to be able to take that example, put it in a file named “hello.nix”, and run <code>nix-build hello.nix</code>; but that won’t work. A <a href="https://stackoverflow.com/questions/44088192/when-and-how-should-default-nix-shell-nix-and-release-nix-be-used">StackOverflow answer</a> discusses that the example is a “callPackage derivation”. (And so since it’s supposed to be invoked with <code>callPackage &lt;callPackage derivation&gt; { }</code>, and <code>callPackage</code> comes from nixpkgs, the full command invocation is like <code>nix-build -E '(import &lt;nixpkgs&gt; { }).callPackage ./path/to/default.nix { }'</code>..). – Whereas, usually “Hello World” is a program I’d expect to be able to compile and run without having to understand much about what’s going on.<br />
– However, it’s imprecise to say “the example is incorrect”.</p>
<p>I say all this having just run into some technical trouble.<br />
I was trying to use KiBot to automatically save 3D previews of a circuitboard designed with Kicad. I could achieve this by running the given Docker image. When I tried running the same program on NixOS, <em>it didn’t work</em>.<br />
Or rather, after some troubleshooting, I found out Kicad wasn’t able to render OpenGL stuff in the Xvfb that was being run; I was able to work-around this by wrapping the Kicad command with virtualgl. – I can’t say I fully understand the issue, or the solution; but it works. Although I feel with NixOS, I had to understand more than if I was using a different Linux distribution.</p>
<p>NixOS can be difficult to use.<br />
I think that’s worth emphasising (with the above in mind) as moderation to a couple of opinions about NixOS I see.<br />
Some new users walk the 95%-wonderful happy path of NixOS and proclaim that NixOS is really easy to use. (Which <em>way</em> undercounts the pain running into the 5% pain-in-the-arse parts of NixOS).<br />
Some users tried NixOS but found it too difficult. – While I think this is fair, and I won’t argue that NixOS is practical enough to be worth the effort, what I’d emphasise instead is that NixOS may require understanding a lot more about what’s going on than other distributions would.</p>]]></summary>
</entry>
<entry>
    <title>Netflix's Narcos Mexico Season 3 is a Let Down</title>
    <link href="http://www.rgoulter.com/blog//posts/narrative/2021-11-07-netflixs-narcos-mexico-season-3-is-a-let-down.html" />
    <id>http://www.rgoulter.com/blog//posts/narrative/2021-11-07-netflixs-narcos-mexico-season-3-is-a-let-down.html</id>
    <published>2021-11-07T00:00:00Z</published>
    <updated>2021-11-07T00:00:00Z</updated>
    <summary type="html"><![CDATA[<p>Netflix’s “Narcos”, and its companion “Narcos: Mexico” are very exciting shows to watch.</p>
<p>I, uh, am under the impression these shows play quite fast and loose with history in order to make a compelling drama. It does make for good entertainment.</p>
<p>I was excited to see “Narcos: Mexico”’s Season 3 recently released, and sat down to binge my way through its episodes. – Unfortunately, I found it disappointing.</p>
<p>“Narcos” especially had this charm of a cat-and-mouse game. You’d feel tense wondering if the good guys would catch the bad guys. I noticed the tension was an inverse of the results: when the tension looked like it might resolve in catching the bad guys, it resolved with the bad guys getting away. But when the tension looked like it leaned in the direction of the bad guys getting away, they’d get caught. – It was very fun to watch.</p>
<p>“Narcos” ran for 3 seasons, with seasons 1 and 2 based on the story of Pablo Escobar; and season 3 based on the story of the Cali cartel. “Narcos: Mexico” sees the rise of the Guadalajara Cartel; presumably future seasons will show us more of El Chapo.</p>
<p>After watching “Narcos: Mexico” season 1, I watched Netflix’s “El Chapo”. – The two shows both dramatise the same set of events. I tend to like the latter more.</p>
<p>Well, “Narcos: Mexico”’s Season 3 is a bit lame. I think it tries to land some emotional punches.. which didn’t really land.</p>
<p>At one point in the show, the good-guys (an American DEA agent, and a Mexican anti-drug military company) capture the brother of the right hand man of so-and-so that they want to catch. They start torturing the kid for information. Then, to the DEA agent’s <em>horror</em>, the kid claims he had Mexican-American dual-citizenship. There’s more hand-wringing in the show, where the DEA agent feels he’s not one of the good guys, because of the torture of the American.<br />
– Ugh. I mean, you can say torture is wrong, or argue torture is bad because it’s ineffective, or argue torture is effective despite being horrible. I don’t see it as defensible to say that citizenship has an impact. What the fuck. (The moral shock certainly can’t be from “torturing your own people” is bad, either. The torture was carried out by Mexicans).<br />
– And while I reckon the show’s writers hold the view that the US are responsible for many bad actions which hurt Mexico.. it feels like the part the story wants you to find shocking is the torture <em>of an American citizen</em>.</p>
<p>In contrast, Netflix’s “El Chapo” has a few standout episodes which really punch through the desensitization that might otherwise come with these gangster shows. Or rather.. it’s easy to see the gangsters killing other gangsters and not feel much about it. But in “El Chapo”, the show takes the time to tell the story from the perspective of lives of ordinary people impacted by the drug trafficking. – We see a poor family lose their daughter; the mother takes the last money they have, gives it to some police officers who then do nothing to help her. We see a young boy kidnapped of the streets, and forced into training as a soldier for the gang. We see poppy farmers who have a tough time under one cartel be forced to work under much worse conditions as another cartel takes over the area.</p>
<p>I guess the other let down to “Narcos: Mexico”’s season 3 is the cat-and-mouse aspect to the story just doesn’t feel as prominent.<br />
Previous seasons of “Narcos” and “Narcos: Mexico” have followed a pattern of following the rise and fall of the biggest drug cartel, and the DEA’s efforts to stop them. Tensions ratchet as the bad guy gets more powerful, and the good guys get closer to catching them.<br />
– In this season, the bad guys that the DEA are chasing never really seem to hold the position of dominance. And the bad guy who seems to be the the most prominent isn’t spending his time getting ahead of prominent threats. There’s no buildup in tension.<br />
Stuff just happens.<br />
– Is that some kind of deliberate meta-narrative harmony with the moral that the war on drugs isn’t a war where the anti-drug enforcement is coherently winning? Nah.</p>
<p>The hand-wringing of “Narcos: Mexico” season 3 falls flat and seems lame in comparison, where the show was previously very strong at telling a good gangster story.</p>]]></summary>
</entry>
<entry>
    <title>Example of Using Nix to Run Software Using Different Build Flags</title>
    <link href="http://www.rgoulter.com/blog//posts/programming/2021-10-31-example-of-using-nix-to-run-software-using-different-build-flags.html" />
    <id>http://www.rgoulter.com/blog//posts/programming/2021-10-31-example-of-using-nix-to-run-software-using-different-build-flags.html</id>
    <published>2021-10-31T00:00:00Z</published>
    <updated>2021-10-31T00:00:00Z</updated>
    <summary type="html"><![CDATA[<p>I recently wanted to use FreeCAD to export a glTF file from a STEP file.</p>
<p>Unfortunately, I found that <a href="https://forum.freecadweb.org/viewtopic.php?f=8&amp;t=31680&amp;p=450917&amp;#p450658">FreeCad needed to be built with OCC built with rapidjson</a>.</p>
<p>The <a href="https://forum.freecadweb.org/viewtopic.php?t=56487&amp;p=486635">suggested solution</a> isn’t <em>hard</em>, as such; but it is more tedious than just installing a package:</p>
<blockquote>
<p>Building from OCC from scratch: 1. get the source code from (https://gitlab.com/blobfish/occt ) –&gt; fillet fix included 2. setup your machine with cmake 3. get freetype2 and tcl/tk 4. setup cmake 5. build occ</p>
</blockquote>
<p>Per <a href="https://dev.opencascade.org/doc/overview/html/build_upgrade__building_occt.html#build_cmake_conf">the opencascade documentation</a> (or e.g. <a href="https://dev.opencascade.org/content/rebuilding-occt-rapidjson">this forum post</a>), this means building opencascade, but with cmake flags: <code>-D USE_RAPIDJSON:BOOL=&quot;ON&quot;</code>.</p>
<p>It turns out Nixpkgs allows for doing this in a concise way:</p>
<p>e.g. with a file <code>freecad.nix</code>:</p>
<pre><code># By convention: this file declares function
# which takes in a set of arguments;
# &#39;pkgs&#39; has a default value of &#39;import &lt;nixpkgs&gt; {}&#39;
{ pkgs ? import &lt;nixpkgs&gt; {} }:

let
  # declare a package opencascade-occt, but with rapidjson support
  opencascade-occt-with-rapidjson =
    pkgs.opencascade-occt.overrideAttrs(oldAttrs: {
      # opencascade-occt depends on rapidjson if built with USE_RAPIDJSON
      nativeBuildInputs = oldAttrs.nativeBuildInputs ++ [ pkgs.rapidjson ];
      # and change which extra cmakeFlags are passed to the configuration.
      cmakeFlags = &#39;&#39;-D USE_RAPIDJSON:bool=&quot;ON&quot;&#39;&#39;;
    });
in
# The result of the function is the freecad package,
# but using the opencascade package we declared above.
pkgs.freecad.override {
  opencascade-occt = opencascade-occt-with-rapidjson;
}</code></pre>
<p>The syntax may look esoteric, but it’s hardly more intimidating than the fancy parts of ECMAScript syntax.</p>
<p>The code declares a function for building a package for freecad. The code is a function as a way of injecting dependencies. The code uses <code>nixpkgs</code> as a whole for our dependency. The code makes use of the <code>pkgs.freecad</code> and <code>pkgs.opencascade-occt</code>, so it doesn’t need to duplicate the effort needed to write those packages. The opencascade here is built with <code>-D USERAPIDJSON:BOOL=&quot;ON&quot;</code> as a flag to CMake; and <code>rapidjson</code> is also given as a dependency. Then this is version of opencascade is given to the <code>pkgs.freecad</code> package.</p>
<p>The <a href="https://nixos.org/manual/nixpkgs/unstable/#chap-overrides">Overriding</a> section of the nix manual explains <code>&lt;pkg&gt;.override</code> vs <code>&lt;pkg&gt;.overrideAttrs</code>. Roughly: <code>&lt;pkg&gt;.overrideAttrs</code> changes things about the way <code>&lt;pkg&gt;</code> is built; e.g. the code above changes the CMake flags. Whereas, <code>&lt;pkg&gt;.override</code> changes what versions of dependencies are used to build a package; e.g. the code above changes the <code>opencascade-occt</code> dependency of freecad to one which was built with rapidjson.</p>
<p>Stuff like this is what makes Nix both very powerful, but also very hard to get used to.</p>
<p>How to use some Nix file like <code>freecad.nix</code> might also be unclear. There are several different ways: e.g. running <code>nix-build freecad.nix</code> then running the <code>./result/bin/freecad</code> which results.. or using the footgun that is <code>nix-env --install</code> and running <code>nix-env --install --file freecad.nix</code>, among others.</p>
<p>The code is more concise without the comments; or without the <code>let</code>:</p>
<pre><code>{ pkgs ? import &lt;nixpkgs&gt; {} }:

with pkgs;
freecad.override {
  opencascade-occt =
    opencascade-occt.overrideAttrs(oldAttrs: {
      nativeBuildInputs = oldAttrs.nativeBuildInputs ++ [ rapidjson ];
      cmakeFlags = &#39;&#39;-D USE_RAPIDJSON:bool=&quot;ON&quot;&#39;&#39;;
    });
}</code></pre>
<p>That said, I don’t know whether anyone would write code like that without having written similar code previously.</p>
<p>I arrived at the above code through refactoring. The naive approach is to copy and paste the Nix files from the nixpkgs code, and make adjustments as necessary. This works, but isn’t very elegant.<br />
– One nice thing about refactoring Nix code, though, is that packages which are built with the same set of inputs don’t require rebuilding. e.g. after building either of the code snippets, the building the other wouldn’t require any further code to be compiled.</p>
<p>I reckon that even that effort is still less tedious than the suggested solution above.<br />
– Or perhaps I’m thinking of this from a yak-shaving perspective: e.g. with the good ol’ just clone and install dependencies and configure and build, you’ll have to repeat this understandable but awkward process on every computer you want to use FreeCAD with glTF export. With the Nix approach, at worst you’d just copy the snippet and rebuild on your computer.</p>
<p>Since rebuilding GUI programs like this can take quite a beefy computer or quite a long time, another nice aspect of Nix is <a href="https://nixos.org/manual/nix/stable/#chap-distributed-builds">the ability to build with other computers</a>. – I’ll have to try that at some point.</p>]]></summary>
</entry>
<entry>
    <title>Using Nix-Shell for Project-Specific Tools for Emacs</title>
    <link href="http://www.rgoulter.com/blog//posts/programming/2021-10-26-using-nix-shell-for-project-specific-tools-for-emacs.html" />
    <id>http://www.rgoulter.com/blog//posts/programming/2021-10-26-using-nix-shell-for-project-specific-tools-for-emacs.html</id>
    <published>2021-10-26T00:00:00Z</published>
    <updated>2021-10-26T00:00:00Z</updated>
    <summary type="html"><![CDATA[<p>One feature VSCode has is its <a href="https://code.visualstudio.com/docs/remote/containers">“Remote - Containers” extension</a> which allows for developing inside a container.</p>
<p>I found this strange when I first heard it; since every time I’ve <code>docker exec -it</code>’d into a container, I’ve had to then further install tools like vim or a better grep. – Instead, I understand the idea is actually to use the container image as a way of distributing a set of tools to use with the editor.</p>
<p>I liked the idea of project-specific tooling more once I made some use of <a href="https://direnv.net/"><code>direnv</code></a>. <code>direnv</code> enables automatically setting environment variables for the directories you <code>cd</code> through, by sourcing any <code>.envrc</code> files it encounters.</p>
<p>That allows e.g. having a separate directory structure for <code>dev</code> and <code>staging</code> deployments, where the <code>dev/.envrc</code> sets the <code>AWS_PROFILE</code> (or <code>CLOUDSDK_ACTIVE_CONFIG_NAME</code>, etc.) environment variable accordingly. – This reduces the risk of mis-matching commands intended for dev in production. But also increases the convenience of not needing to explicitly change between profiles.</p>
<p><code>direnv</code> has also has some integration with <code>nix-shell</code>. e.g. https://hardselius.github.io/2020/nix-shell-and-direnv/ – Although Nix is weird, using dotfiles to enable using different versions of tools depending on the directory is a solution as implemented with tools like <a href="https://github.com/rbenv/rbenv">rbenv</a> (or the more general <a href="https://asdf-vm.com/">asdf-vm</a>).</p>
<p>The <code>direnv</code> + <code>nix-shell</code> combo works for command-line shells, and VSCode can have its Docker containers.</p>
<p>Here’s an example of trying the same trick with Emacs.</p>
<p>e.g. for a Terraform file like <code>main.tf</code>:</p>
<pre class="terraform"><code>terraform {
  required_providers {
    aws = {
      source  = &quot;hashicorp/aws&quot;
      version = &quot;~&gt; 3.0&quot;
    }
  }
}

provider &quot;aws&quot; {
}

variable &quot;ssh_authorized_key&quot; {
  type = string
}

resource &quot;aws_key_pair&quot; &quot;key&quot; {
  key_name_prefix = &quot;ubuntu-vm&quot;
  public_key      = var.ssh_authorized_key
}

resource &quot;aws_security_group&quot; &quot;allow_ssh&quot; {
  name        = &quot;allow_ssh&quot;
  description = &quot;Allow SSH inbound traffic&quot;

  ingress {
    from_port   = 22
    to_port     = 22
    protocol    = &quot;tcp&quot;
    cidr_blocks = [&quot;0.0.0.0/0&quot;]
  }
}

data &quot;aws_ami&quot; &quot;ubuntu&quot; {
  most_recent = true

  filter {
    name   = &quot;name&quot;
    values = [&quot;ubuntu/images/hvm-ssd/ubuntu-focal-20.04-amd64-server-*&quot;]
  }

  filter {
    name   = &quot;virtualization-type&quot;
    values = [&quot;hvm&quot;]
  }

  owners = [&quot;099720109477&quot;] # Canonical
}

resource &quot;aws_instance&quot; &quot;ubuntu&quot; {
  ami           = data.aws_ami.ubuntu.id
  instance_type = &quot;t3.small&quot;

  key_name = aws_key_pair.key.key_name

  vpc_security_group_ids = [aws_security_group.allow_ssh.id]

  associate_public_ip_address = true

  root_block_device {
    volume_size = 20
  }
}

output &quot;vm_public_ip&quot; {
  value = aws_instance.ubuntu.public_ip
}</code></pre>
<p>and a <code>shell.nix</code> with contents:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode nix"><code class="sourceCode bash"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">{</span> <span class="ex">pkgs</span> ? import <span class="op">&lt;</span>nixpkgs<span class="op">&gt;</span> <span class="dt">{}</span> <span class="kw">}</span>:</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="ex">with</span> pkgs<span class="kw">;</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="ex">mkShell</span> {</a>
<a class="sourceLine" id="cb2-5" data-line-number="5">  <span class="ex">buildInputs</span> = [</a>
<a class="sourceLine" id="cb2-6" data-line-number="6">    <span class="ex">terraform</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7">    <span class="ex">terraform-ls</span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8">    <span class="ex">tflint</span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9">  ];</a>
<a class="sourceLine" id="cb2-10" data-line-number="10">}</a></code></pre></div>
<p>(In this case, the shell includes the packages: <code>terraform</code> which is what interprets/runs the <code>main.tf</code>, <code>terraform-ls</code> as the Language Server for LSP, and <code>tflint</code> as the linting tool).</p>
<p>An <code>.envrc</code> can be used to set <code>AWS_PROFILE</code>, <code>AWS_REGION</code>, and <code>TF_VAR_ssh_authorized_key</code>.</p>
<p>To integrate this with Emacs:</p>
<p>Using <a href="https://github.com/travisbhartwell/nix-emacs/"><code>nix-sandbox</code></a> for convenience, we can set some variables in a <code>.dir-locals.el</code> file, e.g.:</p>
<pre class="elisp"><code>((terraform-mode . ((eval . (progn
                              (setq-local lsp-terraform-server
                                          `(&quot;nix-shell&quot;
                                            &quot;--command&quot;
                                            &quot;terraform-ls serve&quot;
                                            ,(nix-current-sandbox)))))))
 (prog-mode . ((flycheck-command-wrapper-function
                . (lambda (command) (apply &#39;nix-shell-command (nix-current-sandbox) command)))
               (flycheck-executable-find
                . (lambda (cmd) (nix-executable-find (nix-current-sandbox) cmd))))))</code></pre>
<p>The <code>lsp-terraform-server</code> variable is used by <a href="https://emacs-lsp.github.io/lsp-mode/page/lsp-terraform/">lsp-mode</a>, and the <code>flycheck-command-wrapper-function</code> is for <a href="https://github.com/flycheck/flycheck">flycheck</a>.</p>
<p>With this, e.g. the <code>terraform-ls</code> from the <code>nix-shell</code> environment can be used for LSP code intelligence, and <code>tflint</code> by flycheck.</p>
<p>I’ve been pretty lazy about figuring out how to setup LSP servers for whatever programming language I’ve been using. Nix doesn’t promise to make that easier. – But what Nix does support is making it easier for someone to make use of a development setup written in Nix (e.g. just running a single “nix-shell” command, rather than following several steps in a blogpost).</p>
<p>I don’t know if project-specific tooling will catch on. I think project-specific tooling looks like it goes well with web applications like replit, gitpod, or GitHub’s codespaces.</p>]]></summary>
</entry>
<entry>
    <title>Static Site Generators are Well Suited to Hobbyist Programming</title>
    <link href="http://www.rgoulter.com/blog//posts/programming/2021-10-24-static-site-generators-are-well-suited-to-hobbyist-programming.html" />
    <id>http://www.rgoulter.com/blog//posts/programming/2021-10-24-static-site-generators-are-well-suited-to-hobbyist-programming.html</id>
    <published>2021-10-24T00:00:00Z</published>
    <updated>2021-10-24T00:00:00Z</updated>
    <summary type="html"><![CDATA[<p>Static site generators are definitely a “for developers” tool. Or that’s the impression I get from seeing that <a href="https://staticsitegenerators.net/">staticsitegenerators.net</a> has hundreds of projects listed, ranging from a few GitHub stars all the way up to tens of thousands of GitHub stars.</p>
<p>I’m reminded of a comment I saw on Hacker News talking about Factorio. Factorio is a game with gameplay which feels very similar to programming. This comment I saw explained, though, that the game’s similarity to programming leads to two sets of reactions to it from programmers: 1. the game is similar to what I put my creative energy into, but without the constraints of needing to be reliable or being told what to do: it’s very fun; 2. the game is similar to what I put my creative energy into, but without any tangible benefit from putting in that work: why would anyone want to ‘play’ this?</p>
<p>My blog is generated with a static site generator, customised using the Haskell programming language.</p>
<p>I don’t think I’d be able to argue that it’s a practical choice if the goal is to serve a blog. – But it’s as good an excuse as any to write something with Haskell.</p>
<p>This weekend I spent some time brushing the project up a bit.</p>
<p>It’s fun.</p>
<p>I’m not familiar enough with Haskell to know all the right idioms. I think <a href="https://github.com/rgoulter/my-hakyll-blog/blob/6958e2a8399e2d32a041592bb74a527fa8ec36a8/site.hs">the code for the site</a> very much smells in places with indications that I don’t know what I’m doing.</p>
<p>Still, I feel I rearranged the code into a nicer, more consistent shape than <a href="https://github.com/rgoulter/my-hakyll-blog/blob/1ef0045662aace8e063d69094e31b76e8062cf25/site.hs">it was in before</a>.</p>
<p>I also tinkered around and updated the Nix files. I think Nix is nice for side projects. It’s often tedious to try and install some old compiler on a system. – With Nix, it’s easier to install from an older version of the package repository.<br />
So when the project needed to build using an older GHC version (and NixOS didn’t like running the GHC version which <code>stack</code> downloaded, because it didn’t have the shared libraries available), Nix can get an older GHC by using the package definition from an older version of the package repository.<br />
– Albeit, Nix has quite a steep learning curve. I wasn’t able to figure out how to do that nicely last time I’d tried to write the Nix files for the project.</p>]]></summary>
</entry>
<entry>
    <title>Follow-up Review of the BM40 Ortholinear Keyboard</title>
    <link href="http://www.rgoulter.com/blog//posts/programming/2021-10-22-follow-up-review-of-the-bm40-ortholinear-keyboard.html" />
    <id>http://www.rgoulter.com/blog//posts/programming/2021-10-22-follow-up-review-of-the-bm40-ortholinear-keyboard.html</id>
    <published>2021-10-22T00:00:00Z</published>
    <updated>2021-10-22T00:00:00Z</updated>
    <summary type="html"><![CDATA[<p>So I’ve had my BM40 for over a year now.</p>
<p>My <a href="../programming/2020-08-22-early-impressions-of-bm40rgb-ortholinear-keyboard.html">initial impressions</a> after getting the keyboard were:</p>
<ul>
<li><p>that it was a <em>relatively</em> cheap, easy to assemble fancy keyboard,</p></li>
<li><p>that was nicer to use compared to a typical keyboard for cases where you could use the computer with both hands on the keyboard,</p></li>
<li><p>that it took a bit of time to get used to. (The alphabetical keys were easy to get used to, since I had trained with ‘touch typing’ discipline to learn the Dvorak; but the symbols took some time to get used to).</p></li>
</ul>
<p>Now that I’ve had more experience with the keyboard, I think those points still pretty much hit the mark.</p>
<p>Perhaps the most important point to add is that I’m still able to use a stock-standard row-staggered keyboard. I don’t lose that ability by using a small/weird keyboard.</p>
<p>Here are some more points for my updated impression:</p>
<h3 id="big-increase-in-comfort">Big Increase in Comfort</h3>
<p>The biggest difference in usage between a BM40 and a standard row-staggered keyboard is the comfort.</p>
<p>I’d point out that the thumb is much stronger than the pinky.</p>
<p>On a standard keyboard, the thumb will press spacebar, and sometimes the left alt key.</p>
<p>On a standard keyboard, the pinkies will press the outermost letters (q, a, z), as well as ctrl, shift, the capslock key, tab, tilde, escape, and on the righthand side, the pinkies are responsible for the extra symbol keys ([], _, +, ), as well as the backspace, and enter keys. – Albeit.. you end up accessing many of these by moving your hand over, and using ring + pinky fingers; and these keys generally don’t need to be pressed very frequently. But this still leaves the pinky doing more work than the thumb.</p>
<p>By comparison, the BM40 does a much better job at utilising the thumbs (and reducing usage of the pinky).</p>
<p>Many layouts on the BM40 keep the two hands together on the inner 10 columns, leaving the outer columns for the pinkies. With the hands on home row, the thumb can reach the spacebar and each thumb can reach the key to the side.</p>
<p>– I think this leaves the lowermost, outer 4 keys in an awkward spot. You have to move your hands in an awkward way to use them. (Albeit, this is no worse than the Ctrl, Win, Alt, etc. of standard keyboards).</p>
<p>In general, better thumb/pinky usage would be to use the thumb more, and pinky even less. I also took a go at designing <a href="https://github.com/rgoulter/keyboard-labs">my own split keyboard</a> (using a small development board to take care of the difficult parts of PCB design), and found this to be relatively comfortable.</p>
<p>With the BM40, you could also try and ‘split’ the hands; the left hand rests on the leftmost 5 columns, the right hand resting on the rightmost 5 columns, leaving a ‘gap’ of two columns in the middle. – I’ve been trying this layout out. I found it a bit difficult to adjust to, but otherwise appreciate it.</p>
<p><img src="https://raw.githubusercontent.com/rgoulter/rgoulter.github.com/master/images/keyboards/bm40rgb/bm40rgb_split.JPG" /></p>
<h3 id="customisable-firmware">Customisable Firmware</h3>
<p>The BM40 supports customising its keyboard firmware.</p>
<p>The <a href="https://docs.qmk.fm/">QMK firmware documentation</a> boasts a large number of features.</p>
<p>The features I’ve found most useful:</p>
<ul>
<li><p>Layers. The idea is a key can behave differently if a “Fn” key is held down. Many laptops will do this in order to provide more functionality without needing to add extra keys. QMK’s layering allows customising what the definitions of each of these layers are, and how they get activated.</p></li>
<li>Tap-Hold keys. A key behaves differently depending on whether you tap it, or hold it down. e.g. a bit like having a button which skips to the next track if tapped, but fast-forwards if held down. (Or treating the CapsLock key as Ctrl key when it’s held, but CapsLock key when tapped).
<ul>
<li>One useful layout this allows is putting the Shift/Ctrl/Windows/Alt key underneath the index/middle/ring/pinky fingers. So you’ll get “jkl;” if tapping, but the modifiers if holding these keys down. Putting these modifier keys on the home row is surprisingly useful.</li>
</ul></li>
<li><p>Combo keys. Invoke some action when tapping multiple keys at once. I don’t make extensive use of this, but my favourite use of it has been to put combos on the two keys “cv” and “m,” to move to the workspace to the left/right. This makes switching between workspaces about as natural as using the gestures on a Macbook trackpad.</p></li>
</ul>
<p>Pretty much all of this customisable functionality is accessible to regular keyboards using software like <a href="https://github.com/kmonad/kmonad">kmonad</a>. – Although having it on the keyboard means you don’t need to fiddle with the OS settings for every computer you make use of.</p>
<h3 id="alternate-recommendation">Alternate Recommendation</h3>
<p>I would also add a recommendation: Consider the BM40 is an ortholinear keyboard with a 4x12 grid of keys (with a 2-key wide spacebar in the middle), the lack of a number row limits its usablility for e.g. gaming.</p>
<p>Keyboards like the XD75 seem like they retain most of the advantages of the BM40, with fewer downsides. e.g. it’s a 5x15 grid of keys (so would be easier to use with gaming?), but also fits into a standard GH60-sized keyboard case. Since the size of the keyboard case is standard, this means there are more options.</p>
<p>Or taking another route: I’ve also seen a bunch of other interesting designs for “split”, two-handed keyboards. The ergodox was the first I saw. The ergodox’s key cluster for thumbs isn’t very good, though. The ergodox also needs a custom case 3D-printed, IIRC.</p>
<p>More recent designs often have a “sandwich style” case where the keyboard’s PCB is ‘sandwiched’ between two laser-cut metal plates. I think it’s easier to find places which will do lasercutting compared to getting access to a 3D printer.</p>
<p>Popular sandwich-style keyboard designs include the corne, the kyria or the lily58 or the sofle keyboard. These involve some very simple soldering. These are often sold in kits at various online stores. If the PCB design files are available, there’s also the option of getting the PCB fabricated &amp; sourcing the other parts yourself.</p>
<h3 id="keyboard-shouldnt-get-in-the-way">Keyboard shouldn’t get in the way</h3>
<p>– In my initial impressions post, I commented that you want a keyboard to be transparent between you and your computer, and not something you have to think about.</p>
<p>While getting used to it, the BM40 does indeed get in the way. And it also gets in the way if you make a significant change to your layout.</p>
<p>But once I got used to the BM40, the “not moving from home row” is wonderful.</p>
<p>In contrast, when I use a standard row-staggered keyboard now it feels like playing the piano. My fingers have to move all over the place, with all sorts of stretching or weird movements.</p>
<h3 id="downside-its-your-keyboard-others-cant-use-it">Downside: It’s <em>your</em> keyboard, others can’t use it</h3>
<p>This will be familiar to those who use customisable text editors like Vim or Emacs. – Once your editor has been customised enough, others can’t use it. (And vice versa).</p>
<p>With small, customisable keyboards it’s the same.</p>
<p>Since the BM40 has fewer keys than the regular keyboard, there’s no obvious convention for where the keys can be expected to go.</p>
<p>If all you’ve got is this small keyboard and you’re ill-equiped to handle situations where someone else might need to type things in.</p>
<h3 id="downside-external-keyboards-are-difficult-to-use-with-laptops">Downside: External Keyboards are Difficult to use with Laptops</h3>
<p>Using a small keyboard is great when you’ve got a desktop setup. It means that much more desk space.</p>
<p>But if you’re using a laptop.. using an external keyboard means more desk space is used up by the keyboard.</p>
<p>One workaround I’ve seen people come up with involve disabling their laptop’s keyboard if using an external keyboard. The keyboard can then be placed on top of the laptop’s keyboard.</p>
<p>Another workaround I saw involved using a small tray that could be placed on top of the laptop keyboard.</p>
<p>This isn’t a downside of the BM40 itself. But, laptop keyboards aren’t ortholinear.</p>
<h3 id="downside-mechanical-keyboards-are-expensive-or-difficult-to-assemble">Downside: Mechanical Keyboards are expensive, or difficult to assemble</h3>
<p>The BM40 is straightforward to assemble. And while it’s cheap relative to other non-standard mechanical keyboards, it’s also quite expensive.</p>
<p>(Standard mechanical keyboards themselves can end up being much cheaper than the BM40 keyboard. e.g. looks like an Anne Pro 2, which is a Bluetooth keyboard, is roughly about half the price of a BM40).</p>
<p>There are cheaper ways to try and assemble a small mechanical keyboard. <a href="https://github.com/rgoulter/keyboard-labs/blob/master/docs/buildguide_rev2021.4_budget.md">I tried designing one which is relatively cheap to build</a>. But custom keyboards which involve fabricating PCBs and doing some soldering work could be described as “difficult to assemble”.</p>
<p>This doesn’t really detract from how much I value having this keyboard, but it does make it harder to recommend to others.</p>
<h3 id="downside-mechanical-keyboards-are-loud">Downside: Mechanical Keyboards are loud</h3>
<p>All these weird/niche keyboards typically use mechanical key switches, since this makes the keyboard cheap enough to produce in low volumes.</p>
<p>In my own space, I consider loud clicky keys an upside. For work spaces, fortunately mechanical key switches don’t need to be clicky. However, I think they’re still louder than standard keyboards.</p>
<p>I worked beside someone who had a mechanical keyboard. His keyboard wasn’t a loud keyboard. I don’t remember being annoyed by the sound.</p>
<p>Though, even more typical keyboards can still be distracting. I once had a colleague who could type very quickly on his Bluetooth Mac keyboard. He said that when he visited one of the satellite offices, the colleagues he sat beside asked him to move away from them since his impressive typing speed was distracting.</p>]]></summary>
</entry>
<entry>
    <title>Dreamy Eyes is Very Sweet</title>
    <link href="http://www.rgoulter.com/blog//posts/narrative/2021-07-29-dreamy-eyes-is-very-sweet.html" />
    <id>http://www.rgoulter.com/blog//posts/narrative/2021-07-29-dreamy-eyes-is-very-sweet.html</id>
    <published>2021-07-29T00:00:00Z</published>
    <updated>2021-07-29T00:00:00Z</updated>
    <summary type="html"><![CDATA[<p>I watched “Dreamy Eyes” on Netflix.<br />
I recommend it. It’s (at times) intensely romantically sweet. Although it doesn’t have a happy ending.<br />
(Well, without a happy ending I suppose “angsty” is more apt than “sweet”).</p>
<p>It’s a drama set in Vietnam during the 1960s - 1970s. The main character has an unrequited love for his childhood friend.</p>
<p>In a sense, the “unrequited love interest over decades” reminds me of “Gone with the Wind”.<br />
In another sense, it’s very similar to Jenny’s story in “Forrest Gump”. (I think “Dreamy Eyes” does a better job. I think “Forrest Gump”’s tone misses “life can be funny and tragic”, and in doing so dampens the heft to what ought to have been some very impactful scenes).</p>
<p>On the other hand, I don’t think you’re really supposed to behave in the same manner as any of the characters in the story. The way they all behave is understandable; but at the same time, the story is so dramatic that it’s all a bit silly. (For example, the main character’s love remains unrequited for decades. Maybe this can be called sweet; but another girl has a completely unreciprocated admiration for the main character that persists for decades too. That’s just silly).</p>
<p>Silliness aside.. I think the situations and characters presented and the actions taken are interesting.</p>
<p>e.g. The story features tones of rural vs urban/modern culture. The main character and the girl he loves grew up together in the same village; but she grows more interested in the attractions of the city.<br />
What I found enhances this tension was the status symbolism of American products. e.g. When the main character reunites with his sweetheart after she has moved to the city, his sweetheart’s mother offers a tin of butter cookies (announcing that these can’t be found in the village), before she drives her car to the disco.</p>
<p>I’ve also found myself thinking about the drama in the film, too. I know <strong>having</strong> to analyse as story is the easiest way to take the fun out of hearing it.. but I also don’t find it so clear where I’d draw the line each of the characters cross from “yeah, that seems fine” to “no, that’s not the good life”.<br />
e.g. I don’t think it spoils too much to reveal that the main character’s love interest gets pregnant out of wedlock. Nothing wicked about that. But e.g. later on in the story, there’s an incident where the love interest walks with a charming date into her store, and doesn’t acknowledge her daughter who had been waiting for her for hours.<br />
The love interest isn’t an easy character to like. (Or as I saw it put once, “you’re not supposed to like the character the same way you like hotdogs”).</p>
<p>But really, what I like about this is the intense romantic angst of the story. We see a sweet romance the main character has as he grows in the village, and we see him return to the same village as an adult and walk the same paths and it just has such an impressive impact.</p>]]></summary>
</entry>
<entry>
    <title>Thoughts on  Netflix's Bridgerton S1</title>
    <link href="http://www.rgoulter.com/blog//posts/romance/2021-02-06-thoughts-on-netflix-bridgerton.html" />
    <id>http://www.rgoulter.com/blog//posts/romance/2021-02-06-thoughts-on-netflix-bridgerton.html</id>
    <published>2021-02-06T00:00:00Z</published>
    <updated>2021-02-06T00:00:00Z</updated>
    <summary type="html"><![CDATA[<p>I just finished watching Netflix’s “Bridgerton” series. I’d enjoyed reading the book series some time ago. The third book in the Bridgeron series was the first book I ever stayed up the whole night to read.</p>
<p>The Bridgerton series is a famous and well-loved series of romance novels by Julia Quinn, featuring the Bridgerton family. The author has a charming voice. Since the stories always end with a happy ending, they’re quite fun to read. I hope the popularity of the Netflix series (and the book series consisting of eight books) means more people get to share in on the fun of reading it.</p>
<p>I enjoyed watching through this first season on Netflix with my girlfriend. Yet.. I can’t quite enthusiastically recommend the show.</p>
<p>I’m not sure who the show was made for. The show has an ambivalent tone to it. Half of the content is sweet and romantic and silly and reliably steers towards a happy ending. The other half is dramatic and somewhat serious and bitter and grim and unromantic and doesn’t even land a happy ending. (This part is original, not coming from the books).<br />
– I can understand people liking both of these things. I can’t understand why a story would be both at once.</p>
<p>The source story is quite sweet. I think the show would be better if it were just this part.<br />
The heroine of this romance is Daphne Bridgerton, and the hero is a proud duke. They get together after complaining how awful it is to be so handsome and desired by everyone else. (This, uh, wasn’t my favourite book of the series). They fight because he really doesn’t want to have children (for proud, manly reasons), she is able to convince him that’s silly, and they live happily ever after.<br />
– The adaptation of this is nice. The duke is played by Regé-Jean Page, who is very handsome.</p>
<p>This part was fun to watch with my girlfriend. At one point, the heroine is mad at the hero and doesn’t want to spent time with him. The heroine is later grumpy at the hero because he never spends time with her. When I pointed out this was a no-win situation for the guy, my girlfriend laughed and said that’s how girls are. (Another fun thing was to play nipple-spotting. We get to see the duke’s nipples all the time during sex scenes; but the duchess’ nipples are hidden even as she rides on top in the nude, thanks to some well placed hair).</p>
<p>The show features pop songs with classical arrangements. Like Taylor Swift’s “Wildest Dreams” or Billie Eilish’s “Bad Guy”. These are much more fun when you’re familiar with the covered music. It’s fitting with the overall presentation. (It’s entertainment which isn’t aiming to faithfully reproduce history; but feel-good pop entertainment dressed up in old-timey clothes).</p>
<p>But the other half?</p>
<p>Well. I was curious to see how the adaptation would be handled.<br />
It seems to be that recently, several popular entertainment series have been overbearingly progressive. Maybe the values isn’t so much of a problem; but the characters tend to be lame and unsophisticated, the writers’ intent bludgeoned into an audience not trusted to appreciate complexity.<br />
– Here, Bridgerton avoids any of that in its romantic half. It’s dramatic half isn’t obnoxious in this way, either.</p>
<p>But I think this dramatic half drags the romantic half down, and mostly just pads out the runtime.</p>
<p>I think part of the problem is its ambivalent tone.<br />
Half the time there’s this romance where the conflict is the guy doesn’t want to marry the woman he loves because of a vow he made against his long dead dad;<br />
and the other half you have e.g. a proud boxer who’s wondering whether he should sacrifice his integrity and throw a match for a great sum of money, or whether he’ll be able to keep providing for his family with his boxing exhibitions in the long term, going from match to match as he grows old.</p>
<p>Other dramatic subplots involve, e.g.: - A side-character’s cousin is pregnant and unmarried; her lover is a solder who hasn’t replied to her letters. She must secure a marriage before her pre-marital pregnancy becomes clear, or else ruin the reputation of the family hosting her. - Daphne’s older brother Anthony has a lower-class opera singer as his mistress. He’s infatuated with this mistress (promising to protect her forever), but his mother chides him for maintaining the relationship. He breaks it off, but still is attracted to her. - etc.</p>
<p>None of these subplots end with a happy ending.</p>
<p>Which is dreary enough.<br />
What exacerbates this is that it feels the writers like this lame dramatic half more than they like the sweet romantic half. – Frequently, characters in this dramatic half will speak their mind sincerely, without cliche. The viewer doesn’t need to suspend disbelief at all to sympathise with these characters.</p>
<p>One example moment in this part I didn’t like was with a subplot where Daphne’s sister Eloise is sleuthing out the identity of the anonymous Lady Whistledown. (Lady Whistledown is like the more recent Gossip Girl of the Gossip Girl series).<br />
Eloise asks the head servant whether she’s the Gossip-Girl, and the servant replies impetuously with “I wouldn’t be working for <em>you</em> if I was earning that kind of money”.<br />
– This feels like the writers want to complain about the rich and priviledged the main characters are; how there’s this huge inequality where servants miserably do work they’d otherwise not choose.<br />
We’re supposed to <em>like</em> the main characters.</p>
<p>It may be that there’s no outright overbearing, lazy progressive preaching.<br />
But.. some shows, if you look for it in the show, and compare the character’s identity (skin colour, sex, etc.), you won’t find significant correlation between what a character looks like and how capable the character is. Characters will be equally capable of good and bad deeds, of being helpful or antagonistic. The characters are all written respectfully.<br />
Bridgerton … just isn’t one of those shows. But there’s nothing really stopping it from doing that.</p>
<p>That said. I was surprised the show included a part where the newly wed duchess unintentionally offends the townspeople. She was asked which of the three pigs at a festival should be slaughtered. Aghast at the thought of violence, she says none of them are to be killed. This effectively denies any of the townspeople the right to make money from their pigs.<br />
It’s a nice example of Chesterton’s fence.</p>
<p>The Bridgerton series features eight books, and various other series in the same setting. If it remains one book per season, that’d be eight seasons. Eight seasons is a lot. Moreso because the show creates its own subplots which diverge from the much better source material. I don’t think this dramatic half is good enough to last that long. I’m curious to see what they do with it.</p>]]></summary>
</entry>

</feed>
